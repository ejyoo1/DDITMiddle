<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="partyBoard">
	
	<insert id="insertPartyBoard" parameterClass="kr.or.ddit.partyBoard.vo.PartyBoardVO">
		INSERT INTO TB_PARTY_BOARD (
			CODE
			, BOARD_SEQ
			, USER_ID
			, BOARD_TITLE
			, BOARD_DATE
			, BOARD_CONTENT
			  <isNotEmpty property="restCode">
			, REST_CODE
			  </isNotEmpty>
			  <isNotEmpty property="price">
			, PRICE
			  </isNotEmpty>
			  <isNotEmpty property="distance">
			, DISTANCE
			  </isNotEmpty>
			  <isNotEmpty property="distance">
			, REST_TYPE
			  </isNotEmpty>
			, PARTY_YN
			, PARTY_START
			, PARTY_END
			  <isNotEmpty property="atchFileId">
			, ATCH_FILE_ID
			  </isNotEmpty>
			, BOARD_HIT
			, BOARD_DELETE
		)
		VALUES (
			code
			, SEQ_PARTY_BOARD.NEXTVAL
			, userId
			, boardTitle
			, boardDate
			, boardContent
			  <isNotEmpty property="restCode">
			, restCode
			  </isNotEmpty>
			  <isNotEmpty property="price">
			, price
			  </isNotEmpty>
			  <isNotEmpty property="distance">
			, distance
			  </isNotEmpty>
			  <isNotEmpty property="distance">
			, restType
			  </isNotEmpty>
			, partyYn
			, SYSDATE
			, partyEnd
			  <isNotEmpty property="atchFileId">
			, atchFileId
			  </isNotEmpty>
			, boardHit
			, boardDelete
		)
	</insert>
	
	<update id="updatePartyBoard" parameterClass="kr.or.ddit.partyBoard.vo.PartyBoardVO">
		UPDATE TB_PARTY_BOARD
		SET	   BOARD_TITLE = #boardTitle#
			   , BOARD_CONTENT = #boardContent#
			     <isNotEmpty property="restCode">
			   , REST_CODE = #restCode#
			     </isNotEmpty>
			     <isNotEmpty property="price">
			   , PRICE = #price#
			     </isNotEmpty>
			     <isNotEmpty property="distance">
			   , DISTANCE = #distance#
			     </isNotEmpty>
			     <isNotEmpty property="distance">
			   , REST_TYPE = #restType#
			     </isNotEmpty>
			   , PARTY_END = #partyEnd#
			     <isNotEmpty property="atchFileId">
			   , ATCH_FILE_ID = #atchFileId#
			     </isNotEmpty>
		WHERE  USER_ID = #userId#
		AND    BOARD_SEQ = #boardSeq#
	</update>
	
	<update id="deletePartyBoard" parameterClass="kr.or.ddit.partyBoard.vo.PartyBoardVO">
		UPDATE TB_PARTY_BOARD
		SET    BOARD_DELETE = 'Y'
		WHERE  USER_ID = #userId#
		AND    BOARD_SEQ = #boardSeq#
	</update>
	
	<select id="getPartyBoard" parameterClass="long" resultClass="kr.or.ddit.partyBoard.vo.PartyBoardVO">
		SELECT 
		CODE                								code
		,BOARD_SEQ          								boardSeq
		,USER_ID            								userId
		,BOARD_TITLE        								boardTitle
		,TO_CHAR(BOARD_DATE, 'MM/DD')         		boardDate
		,BOARD_CONTENT      								boardContent
		,REST_CODE          								restCode
		,PRICE              								price
		,DISTANCE           								distance
		,REST_TYPE											restType
		,PARTY_YN           								partyYn
		,TO_CHAR(PARTY_START, 'MM/DD')				partyStart
		,TO_CHAR(PARTY_END, 'MM/DD')  				partyEnd
		,ATCH_FILE_ID       								atchFileId
		,BOARD_HIT          								boardHit
		,BOARD_DELETE       								boardDelete
		FROM   TB_PARTY_BOARD
		WHERE  1 = 1
		AND    BOARD_SEQ = #boardSeq#
	</select>
	
	<select id="getPartyBoardList" parameterClass="kr.or.ddit.partyBoard.vo.PartyBoardVO" resultClass="kr.or.ddit.partyBoard.vo.PartyBoardVO">
		SELECT 
		CODE                								code
		,BOARD_SEQ          								boardSeq
		,USER_ID            								userId
		,BOARD_TITLE        								boardTitle
		,TO_CHAR(BOARD_DATE, 'MM/DD')         		boardDate
		,BOARD_CONTENT      								boardContent
		,REST_CODE          								restCode
		,PRICE              								price
		,DISTANCE           								distance
		,REST_TYPE											restType
		,PARTY_YN           								partyYn
		,TO_CHAR(PARTY_START, 'MM/DD')        		partyStart
		,TO_CHAR(PARTY_END, 'MM/DD')          		partyEnd
		,ATCH_FILE_ID       								atchFileId
		,BOARD_HIT          								boardHit
		,BOARD_DELETE       								boardDelete
		FROM   TB_PARTY_BOARD
		WHERE  1 = 1
		AND    BOARD_DELETE = 'N'
	</select>
	
	<select id="getPartyBoardAllList" parameterClass="kr.or.ddit.partyBoard.vo.PartyBoardVO" resultClass="kr.or.ddit.partyBoard.vo.PartyBoardVO">
		SELECT *
		FROM   TB_PARTY_BOARD
	</select>
	
	<!-- 조회수 -->
	<update id="countHits" parameterClass="long">
		UPDATE TB_PARTY_BOARD
		SET    BOARD_HIT = (BOARD_HIT + 1)
		WHERE  BOARD_SEQ = #boardSeq#
	</update>
</sqlMap>